<div class="app-container">

  <div class="arlas-map">
    <arlas-mapgl [geojsondata]="mapglcontributor?.geojsondata" (onRemoveBbox)="mapglcontributor?.onRemoveBbox($event)" 
    [style]="mapComponentConfig.basemapUrl"
      [margePanForLoad]="mapComponentConfig.margeExtendPctForLoad" [margePanForTest]="mapComponentConfig.margeExtendPctForTest"
      (onChangeBbox)="mapglcontributor?.onChangeBbox($event)" 
      [initCenter]="initCenter"
      [initZoom]="2" 
      [paintRuleClusterLineRectangle]="mapComponentConfig.paintRuleClusterLineRectangle" 
      [paintRuleClusterFillRectangle]="mapComponentConfig.paintRuleClusterFillRectangle"
        [paintRuleFeatureLine]="mapComponentConfig.paintRuleFeatureLine" 
        [paintRuleFeatureFill]="mapComponentConfig.paintRuleFeatureFill"
      [zoomToPrecisionCluster]="mapglcontributor?.zoomToPrecisionCluster" 
      [idFeatureField]="mapComponentConfig.idFieldName"
      [maxPrecision]="mapglcontributor?.maxPrecision.split(',')[1]" 
     [paintRuleGeoBox]="mapComponentConfig.paintRuleGeoBox" 
      [fontClusterlabel]="mapComponentConfig.fontClusterlabel"
      (onMove)="mapglcontributor?.onMove($event)"
      [drawType]="mapDrawType" 
      [geoboxdata]="mapglcontributor?.geojsonbbox">
    </arlas-mapgl>

  </div>

  <div class="arlas-search">
    <arlas-search (valuesChangedEvent)="filterSearch($event)">
    </arlas-search>
  </div>
  <div class="arlas-filters-chips">
    <arlas-filters-chips></arlas-filters-chips>
  </div>

  <div class="arlas-timeline">
    <arlas-histogram #timeline [xTicks]="7" [yTicks]="2" [xLabels]="7" [yTicks]="2" [chartType]="chartType.area" [dataType]="dataType.time"
      [chartTitle]="'Number of airplanes positions over time'" [customizedCssClass]="'custom-arlas-timeline'" [chartHeight]="100" [dateUnit]="dateUnit.millisecond"
      [xAxisPosition]="position.top" [descriptionPosition]="position.top" (valuesListChangedEvent)="timelinecontributor?.valueChanged($event)"
      [intervalListSelection]="timelinecontributor?.intervalListSelection" [multiselectable]="false"
      [data]="timelinecontributor?.chartData" [intervalSelection]="timelinecontributor?.intervalSelection"></arlas-histogram>
  </div>
  <div class="arlas-analytics--container" (mouseenter)="showToggle()" (mouseleave)="hideToggle()">
    <div *ngIf="!isFilterMode" class="arlas-analytics__thumbnails" (click)="showAnalyticsAsFilters($event)">
      <div *ngFor="let histogram of histograms">
        <div *ngIf="!histogram.isFilter" class="arlas-analytics__one-analytic">
          <label class="arlas-analytics__title">
            <mat-icon class="arlas-analytics__icon">
              {{histogram.icon}}
            </mat-icon>
            <span class="arlas-analytics__title--text">{{histogram.title}}</span>
          </label>
          <div class="arlas-analytics__chart-container">
            <arlas-histogram [chartType]="histogram.chartType" [dataType]="dataType.numeric" [xLabels]="6" [yTicks]="2" [yTicks]="2"
              [isHistogramSelectable]=false [showXTicks]=false [showYTicks]=false [showYLabels]=false [showXLabels]=false [customizedCssClass]="'custom-arlas-histogram__thumbnail'"
              [chartHeight]="histogram.chartHeight" [dateUnit]="histogram.dateUnit" [data]="histogram.histogramContributor?.chartData"
              [paletteColors]="histogram.paletteColor" [intervalSelection]="histogram.histogramContributor?.intervalSelection"
              [multiselectable]="false"
              [intervalListSelection]="histogram.histogramContributor?.intervalListSelection" 
              [descriptionPosition]="position.bottom"></arlas-histogram>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="isFilterMode" class="arlas-analytics__filters">
      <mat-icon class="arlas-analytics__back_to_thumbnails__icon" color="red" (click)="showAnalyticsAsThumbnails($event)">clear</mat-icon>
      <div *ngFor="let histogram of histograms">
        <div *ngIf="histogram.isFilter" class="arlas-analytics__one-analytic">
          <label class="arlas-analytics__title">
            <mat-icon class="arlas-analytics__icon">
              {{histogram.icon}}
            </mat-icon>
            <span class="arlas-analytics__display">{{histogram.histogramContributor.getFilterDisplayName()}}</span>
          </label>
          <arlas-histogram  [xTicks]="4" [xLabels]="4" [yTicks]="1" [yLabels]="4" [chartType]="histogram.chartType"
            [dataType]="dataType.numeric" [showXTicks]=true [showYTicks]=true [customizedCssClass]="'custom-arlas-histogram__filter'"
            [chartHeight]="histogram.chartHeight" [dateUnit]="dateUnit.millisecond" [data]="histogram.histogramContributor?.chartData"
            (valuesListChangedEvent)="histogram.histogramContributor?.valueChanged($event)" [intervalSelection]="histogram.histogramContributor?.intervalSelection"
              [multiselectable]="false"
              [intervalListSelection]="histogram.histogramContributor?.intervalListSelection" 
            [descriptionPosition]="position.bottom" [paletteColors]="histogram.paletteColor"></arlas-histogram>
        </div>
      </div>
    </div>
  </div>
  <mat-progress-bar class="arlas-progression" *ngIf="collaborativeService.totalSubscribe>0" color="primary" mode="indeterminate"></mat-progress-bar>
</div>
