<arlas-tool-root></arlas-tool-root>
<div class="app-container">
  <arlas-dataset></arlas-dataset>
  <div class="arlas-map">
    <arlas-mapgl #map [geojsondata]="mapglContributor?.geojsondata" (onRemoveBbox)="mapglContributor?.onRemoveBbox($event)"
      [style]="mapComponentConfig?.style"
      [margePanForLoad]="mapComponentConfig?.margePanForLoad" [margePanForTest]="mapComponentConfig?.margePanForTest"
      (onChangeBbox)="mapglContributor?.onChangeBbox($event)"
      [initCenter]="mapComponentConfig?.initCenter"
      [initZoom]="mapComponentConfig?.initZoom"
      [minZoom]="mapComponentConfig?.minZoom"
      [maxZoom]="mapComponentConfig?.maxZoom"
      [displayScale]="mapComponentConfig?.displayScale"
      [maxWidthScale]="mapComponentConfig?.maxWidthScale"
      [unitScale]="mapComponentConfig?.unitScale"
      [zoomToPrecisionCluster]="mapglContributor?.zoomToPrecisionCluster"
      [idFeatureField]="mapComponentConfig?.idFieldName"
      [maxPrecision]="mapglContributor?.maxPrecision"
      (onMove)="mapglContributor?.onMove($event)"
      [geoboxdata]="mapglContributor?.geojsonbbox"
      [mapLayers]="mapComponentConfig?.mapLayers"
      [mapSources]="mapComponentConfig?.mapSources"
      [displayLayerSwitcher]=true
      [featureToHightLight]="featureToHightLight"
      [featuresToSelect]="featuresToSelect"
      [boundsToFit]="fitbounds">
    </arlas-mapgl>
  </div>

  <div class="arlas-top-analytics">
    <mat-basic-chip class="arlas-search-toggle" [class.arlas-search-toggle-corner]="searchOpen" (click)="searchOpen=!searchOpen" matTooltip="{{'Toggle search' | translate}}">
      <mat-icon class="primary" [class.arlas-search-rotate]="searchOpen">keyboard_arrow_right</mat-icon>
      <mat-icon>search</mat-icon>
    </mat-basic-chip>
    <div class="arlas-search" [hidden]="!searchOpen">
      <arlas-search #search (valuesChangedEvent)="filterSearch($event)"></arlas-search>
    </div>
    <span class="arlas-analytics-refresh" [hidden]="!this.refreshButton" (click)="refreshComponents()" matTooltip="{{'Refresh components' | translate}}">
      <mat-icon>refresh</mat-icon>
    </span>
    <mat-basic-chip class="arlas-analytics-toggle" [hidden]="!this.analytics" (click)="analyticsOpen=!analyticsOpen" matTooltip="{{'Toggle analytics board' | translate}}">
      <mat-icon class="primary" [class.arlas-analytics-rotate]="analyticsOpen">keyboard_arrow_down</mat-icon>
      <mat-icon>pie_chart</mat-icon>
    </mat-basic-chip>
  </div>
  <div class="arlas-filters-chips">
    <arlas-filters-chips></arlas-filters-chips>
  </div>

  <div class="arlas-analytics--container" *ngIf="analyticsOpen">
    <arlas-analytics-board [groups]="this.analytics" (boardOutputs)="getBoardEvents($event)" ></arlas-analytics-board>
  </div>
  <arlas-timeline *ngIf="timelineComponentConfig" class="arlas-timeline-toolkit" [activeDatePicker]="true" [timelineComponent]="timelineComponentConfig" [detailedTimelineComponent]="detailedTimelineComponentConfig" ></arlas-timeline>
  <mat-progress-bar class="arlas-progression" *ngIf="collaborativeService.totalSubscribe>0" color="primary" mode="indeterminate"></mat-progress-bar>
</div>
