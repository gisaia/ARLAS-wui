<div>
    <mat-sidenav-container class="sidenav-container">
      <mat-sidenav #leftSidenav mode="side" opened>
        <arlas-left-menu [version]="version" [layersVisibilityStatus]="arlasMapComponent?.layersVisibilityStatus"
          (menuEventEmitter)="consumeMenuEvents($event)" [toggleStates]="menuState" [collections]="collections"
          [isEmptyMode]="arlasStartUpService.emptyMode"></arlas-left-menu>
      </mat-sidenav>
      <mat-sidenav-content style="margin-left: 67px;">
        <div class="main_content">
          <div *ngIf="arlasStartUpService.shouldRunApp">
            <div class="app-container" [class.app-container-reduce]="listOpen"
              [class.app-container-with-list]="resultlistService.rightListContributors.length > 0 && !listOpen && resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.hasGridMode">
              <arlas-bookmark-menu *ngIf="!arlasStartUpService.emptyMode"></arlas-bookmark-menu>
              <div class="arlas-map">
                <arlas-map #arlasmap [analyticsOpen]="analyticsOpen" [hiddenResultlistTabs]="hiddenResultlistTabs"  [actionOnPopup]="actionOnPopup"   ></arlas-map>
                <div *ngIf="resultlistService.rightListContributors.length > 0" class="side-result-list-toggle"
                  [class.side-result-list-toggle-open]="listOpen"
                  [class.side-result-list-toggle-open-no-grid]="!resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.hasGridMode && !listOpen">
                  <div class="side-result-list-icon mat-elevation-z1" [class.side-result-list-icon-open]="listOpen"
                    (click)="toggleList()">
                    <mat-icon *ngIf="!listOpen">arrow_back_ios</mat-icon>
                    <mat-icon *ngIf="listOpen">arrow_forward_ios</mat-icon>
                  </div>
                </div>
                <div class="side-result-list-preview mat-elevation-z1" [class.side-result-list-preview-close]="listOpen"
                  *ngIf="!!resultlistService.previewListContrib && !listOpen && resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.hasGridMode">
                  <arlas-result-list style="height:100%" [rowItemList]="resultlistService.previewListContrib.data"
                    [fieldsList]="resultlistService.previewListContrib.fieldsList"
                    [detailedDataRetriever]="resultlistService.previewListContrib.detailedDataRetriever"
                    [fieldsConfiguration]="resultlistService.previewListContrib.fieldsConfiguration"
                    [dropDownMapValues]="resultlistService.previewListContrib.dropDownMapValues"
                    [filtersMap]="resultlistService.previewListContrib.filtersMap" [highlightItems]="resultlistService.previewListContrib.highlightItems"
                    [nbLinesBeforeFetch]="10" [nbGridColumns]="1" [tableWidth]="150" [defautMode]="1"
                    [fetchState]="resultlistService.previewListContrib.fetchState" [globalActionsList]="[]"
                    [isGeoSortEnabled]="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.isGeoSortActived"
                    [options]="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.options"
                    [displayFilters]="false"
                    (thumbnailFitEvent)="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier).fitThumbnail = $event"
                    (visibleItems)="resultlistService.updateMapStyleFromScroll($event, resultlistService.previewListContrib.collection)"
                    (onChangeItems)="resultlistService.updateMapStyleFromChange($event, resultlistService.previewListContrib.collection)"
                    (clickOnTile)="clickOnTile($event)"
                    [useColorService]="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.useColorService"
                    [cellBackgroundStyle]="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.cellBackgroundStyle"
                    [colorsSaturationWeight]="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.colorsSaturationWeight"
                    [keysToColors]="resultlistService.resultListConfigPerContId.get(resultlistService.previewListContrib.identifier)?.keysToColors"
                    (sortColumnEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'sortColumnEvent', data: $event })"
                    (paginationEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'paginationEvent', data: $event })"
                    (geoSortEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'geoSortEvent', data: $event })"
                    (geoAutoSortEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'geoAutoSortEvent', data: $event })"
                    (consultedItemEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'consultedItemEvent', data: $event })"
                    (actionOnItemEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'actionOnItemEvent', data: $event })"
                    (globalActionEvent)="resultlistService.getBoardEvents({ origin: resultlistService.previewListContrib.identifier, event: 'globalActionEvent', data: $event })">
                  </arlas-result-list>
                </div>
                <div *ngIf="resultlistService.rightListContributors.length > 0" class="side-result-list mat-elevation-z1" [class.one-tab]="resultlistService.rightListContributors.length === 1"
                  [class.side-result-list-open]="listOpen">
                  <arlas-list [selectedListTabIndex]="selectedListTabIndex" [listOpen]="listOpen" [nbGridColumns]="3" [tableWidth]="450" #arlaslists></arlas-list>
                </div>
              </div>
  
              <div class="arlas-top-analytics">
                <mat-basic-chip *ngIf="chipsSearchContributor" class="arlas-search-toggle"
                  [class.arlas-search-toggle-corner]="searchOpen" (click)="searchOpen=!searchOpen"
                  matTooltip="{{'Toggle search' | translate}}">
                  <mat-icon class="primary" [class.rotate-icon]="searchOpen">keyboard_arrow_right</mat-icon>
                  <mat-icon>search</mat-icon>
                </mat-basic-chip>
                <div *ngIf="chipsSearchContributor" class="arlas-search" [hidden]="!searchOpen">
                  <arlas-search #search id="search" [searchContributor]="chipsSearchContributor"></arlas-search>
                </div>
                <span class="arlas-analytics-refresh" [hidden]="!this.refreshButton" (click)="refreshComponents()"
                  matTooltip="{{'Refresh components' | translate}}">
                  <mat-icon>refresh</mat-icon>
                </span>
                <mat-basic-chip class="arlas-analytics-toggle" [hidden]="!this.analytics" (click)="toggleAnalytics()"
                  matTooltip="{{'Toggle analytics board' | translate}}">
                  <mat-icon class="primary" [class.arlas-analytics-rotate]="analyticsOpen">keyboard_arrow_down</mat-icon>
                  <mat-icon>poll</mat-icon>
  
                </mat-basic-chip>
              </div>
              <div *ngIf="!arlasStartUpService.emptyMode" class="arlas-filters-chips">
                <arlas-filter [title]="appName" [collectionToDescription]="resultlistService?.collectionToDescription"
                  [backgroundColor]="appNameBackgroundColor" [units]="appUnits" (zoomEvent)="zoomToData($event)">
                </arlas-filter>
              </div>
              <div class="arlas-analytics--container" *ngIf="analyticsOpen && !arlasStartUpService.emptyMode">
                <arlas-analytics [hiddenAnalyticsTabs]="hiddenAnalyticsTabs"></arlas-analytics>
              </div>
  
              <arlas-timeline #timeline *ngIf="timelineComponentConfig" class="arlas-timeline-toolkit"
                [activeDatePicker]="true" [timelineComponent]="timelineComponentConfig"
                [detailedTimelineComponent]="detailedTimelineComponentConfig">
              </arlas-timeline>
  

              <mat-progress-bar class="arlas-progression" *ngIf="collaborativeService.totalSubscribe>0" color="primary"
                mode="indeterminate"></mat-progress-bar>
              <arlas-configs-list *ngIf="menuState.configs" (openHubEventEmitter)="menuState.configs = false">
              </arlas-configs-list>
            </div>
  
          </div>
  
        </div>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>
  